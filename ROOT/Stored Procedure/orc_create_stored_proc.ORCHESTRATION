{"job":{"components":{"6338":{"id":6338,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-560,"y":-128,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[6342],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Start","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6339":{"id":6339,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-400,"y":-112,"width":32,"height":32,"inputConnectorIDs":[6342],"outputSuccessConnectorIDs":[6510],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"created stored proc"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CREATE OR REPLACE PROCEDURE actiontobeperformed(src_db STRING,\n\t\t\t\t\t\t\t\t\t\t\t\tsrc_dbschema string,\n\t\t\t\t\t\t\t\t\t\t\t\ttablename string,\n\t\t\t\t\t\t\t\t\t\t\t\ttgt_db string,\n\t\t\t\t\t\t\t\t\t\t\t\ttgt_dbschema string,\n\t\t\t\t\t\t\t\t\t\t\t\taction_type string,\n\t\t\t\t\t\t\t\t\t\t\t\ttable_view char(1))\nreturns string\nlanguage javascript\nexecute as caller\nas\n$$\n\nvar action_type  = ACTION_TYPE;\nvar src_db       = SRC_DB;\nvar src_dbschema = SRC_DBSCHEMA;\nvar tablename    = TABLENAME;\nvar tgt_db       = TGT_DB;\nvar tgt_dbschema = TGT_DBSCHEMA;\nvar table_view   = TABLE_VIEW;\nvar result       = \"\";\n\nvar sql_query_text = \"\";\ntry\n{\n\nif (action_type.toUpperCase() == 'CREATE' && table_view.toUpperCase() == 'T')\n{\nvar sql_query_text = 'CREATE OR REPLACE TABLE ' + tgt_db + '.' + tgt_dbschema + '.' + tablename + ' like ' + src_db +\n'.' + src_dbschema + '.' + tablename + ';'\nsnowflake.createStatement({sqlText:sql_query_text}).execute();\nresult = \"Table created successfully: \" + tgt_db + '.' + tgt_dbschema + '.' + tablename\n}\n\nelse if (action_type.toUpperCase() == 'INSERT' && table_view.toUpperCase() == 'I')\n{\nvar sql_query_text = 'INSERT INTO ' + tgt_db + '.' + tgt_dbschema + '.' + tablename + ' select * from ' + src_db +\n'.' + src_dbschema + '.' + tablename + ';'\nsnowflake.createStatement({sqlText:sql_query_text}).execute();\nresult = \"Insertion successfully completed: \" + tgt_db + '.' + tgt_dbschema + '.' + tablename\n}\nelse\n{\nresult = \"Fail: Please give proper parameter \\n\" + \"1.If INSERTing the data then parameter should be only Table(t/T)\\n\"\n}\n\n}\ncatch (err)\n{\nresult += \"\\n Code: \" + err.code + \"\\n State: \" + err.state;\nresult += \"\\n Message: \" + err.message;\nresult += \"\\n Stack Trace:\\n\" + err.stackTraceTxt;\nresult += \"Failed Query Text: \" +sql_query_text;\nthrow result;\n}\nreturn result;\n$$\n;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6340":{"id":6340,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-192,"y":-128,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"calling stored proc for table creation in dest schema"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'BROKER','TEST_DST', 'DEST_SCHEMA','CREATE', 'T');\nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'CATEGORIES','TEST_DST', 'DEST_SCHEMA', 'CREATE', 'T'); \nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'COMPLAIN','TEST_DST', 'DEST_SCHEMA', 'CREATE', 'T');\nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'CUSTOMER','TEST_DST', 'DEST_SCHEMA', 'CREATE', 'T'); \nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'PRIORITIES','TEST_DST', 'DEST_SCHEMA', 'CREATE', 'T');\nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'PRODUCT','TEST_DST', 'DEST_SCHEMA','CREATE', 'T');\nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'REGION','TEST_DST', 'DEST_SCHEMA','CREATE', 'T');\nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'SOURCES','TEST_DST', 'DEST_SCHEMA','CREATE', 'T');\nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'STATE_REGION','TEST_DST', 'DEST_SCHEMA','CREATE', 'T');\nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'STATUSES','TEST_DST', 'DEST_SCHEMA','CREATE', 'T');\nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'TYPE','TEST_DST', 'DEST_SCHEMA','CREATE', 'T');"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"6341":{"id":6341,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-192,"y":-16,"width":32,"height":32,"inputConnectorIDs":[6510],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"calling stored proc for data insertion"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'BROKER','TEST_DST', 'DEST_SCHEMA','INSERT', 'I');\nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'CATEGORIES','TEST_DST', 'DEST_SCHEMA', 'INSERT', 'I'); \nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'COMPLAIN','TEST_DST', 'DEST_SCHEMA', 'INSERT', 'I');\nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'CUSTOMER','TEST_DST', 'DEST_SCHEMA', 'INSERT', 'I'); \nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'PRIORITIES','TEST_DST', 'DEST_SCHEMA', 'INSERT', 'I');\nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'PRODUCT','TEST_DST', 'DEST_SCHEMA','INSERT', 'I');\nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'REGION','TEST_DST', 'DEST_SCHEMA','INSERT', 'I');\nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'SOURCES','TEST_DST', 'DEST_SCHEMA','INSERT', 'I');\nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'STATE_REGION','TEST_DST', 'DEST_SCHEMA','INSERT', 'I');\nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'STATUSES','TEST_DST', 'DEST_SCHEMA','INSERT', 'I');\nCALL actiontobeperformed ('DEMO_DATABASE','DEMO_SCHEMA', 'TYPE','TEST_DST', 'DEST_SCHEMA','INSERT', 'I');"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"6510":{"id":6510,"sourceID":6339,"targetID":6341}},"failureConnectors":{},"unconditionalConnectors":{"6342":{"id":6342,"sourceID":6338,"targetID":6339}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{},"variables":{},"grids":{}},"info":{"name":"orc_create_stored_proc","description":"","type":"ORCHESTRATION","tag":"3d8e3672-1005-42c8-9536-6daf25bcd651"}}